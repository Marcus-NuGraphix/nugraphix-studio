# Decisions Log

Last updated: 2026-02-18
Status: Active

## Entries

| Date | Decision | Context | Owner | Follow-up |
| --- | --- | --- | --- | --- |
| 2026-02-18 | Adopt numbered docs tracks (`00`-`08`) as production-hardening system of record | Existing docs were optimized for Blog MVP and needed a dedicated hardening execution surface | Eng | Keep cross-links updated in `docs/README.md` and `docs/plans/README.md` |
| 2026-02-18 | Archive legacy roadmap and phase docs under `docs/archive/*` | Two parallel active planning sets increased maintenance risk and pointer drift | Eng | Keep `docs/00-index.md` as single active execution entry point |
| 2026-02-18 | Standardize local seed command with `db:seed` alias | Phase 1 runbooks expected `db:seed`; scripts only exposed `db:seed:blog-demo` | Eng | Add broader bootstrap seed workflow for admin/user setup in Phase 1 |
| 2026-02-18 | Treat local Docker Postgres as canonical Phase 1 validation target, with explicit `DATABASE_URL` override during verification | `.env.local` may point to remote DB; local-compose validation must avoid mutating remote environments | Eng | Codify in env runbook and CI smoke checks |
| 2026-02-18 | Accept temporary local `db:push` fallback while migration chain is reconciled | `db:migrate` currently does not create full auth schema on clean local DB, causing seed failure | Eng | Publish ADR-0031 and prioritize migration backfill task (T-010) |
| 2026-02-18 | Retire `db:push` as canonical bootstrap step after migration reconciliation | Added `drizzle/0002_schema_reconciliation.sql` + snapshot/journal updates; clean local bootstrap now passes with `db:migrate` + `db:seed` | Eng | Add CI/phase smoke check to enforce migrate-first bootstrap |
| 2026-02-18 | Enforce `fast-xml-parser@5.3.6` via `pnpm` override until AWS SDK publishes patched downstream dependency metadata | `@aws-sdk/xml-builder` latest metadata still pins `fast-xml-parser@5.3.4`, while installed graph can be safely forced to patched version | Eng | Remove override once upstream chain no longer requires it |
| 2026-02-18 | Promote deterministic bootstrap seeding (`db:seed`) to include auth users + content baseline + blog demo data | Phase 1 required idempotent local data for admin/auth/content validation, not only blog posts | Eng | Add migration+seed smoke gate in CI/Phase 1 exit checks |
| 2026-02-18 | Enforce migrate+seed bootstrap smoke gate in CI | Phase 1 required automated proof that migrations alone can bootstrap schema and deterministic seeds remain rerunnable | Eng | Keep Postgres service-based smoke gate aligned with seed contract updates |
| 2026-02-18 | Standardize DB latency benchmarking with a scriptable harness and artifact path | Phase 3 needs repeatable, comparable measurements across regions and providers before hosting cutover decisions | Eng | Execute ZA runner benchmarks against current and candidate endpoints |
| 2026-02-18 | Treat current Singapore Neon endpoint as latency-risk baseline from ZA pending replacement decision | ZA benchmark run (`p95=526.62 ms`) exceeded acceptable target bands and establishes urgency for candidate-region validation | Eng | Benchmark candidate A/B endpoints from ZA and finalize hosting decision |
| 2026-02-18 | Treat Phase 4 component audit baseline as mandatory gate before refactors | Design-system docs were template-only; implementation work needed an evidence-backed queue and boundary map first | Eng | Execute T-013/T-014/T-015 in scoped, verifiable patches |
| 2026-02-18 | Keep chart/email literal colors as controlled temporary exceptions, not new token standards | `chart.tsx` and email templates use third-party/rendering-constrained color literals; immediate broad refactor is higher risk than phased extraction | Eng | Remove exceptions through targeted follow-up tasks and document replacement contract |
| 2026-02-18 | Establish `src/lib` expansion matrix before moving shared code into new domains | Phase 4 required explicit ownership rules to prevent feature-to-lib leakage while adding `config/constants/validation/permissions/api/flags/cache` | Eng | Execute incremental implementation starting with `config`, `constants`, and `flags` scaffolding |
| 2026-02-18 | Implement `src/lib` Phase 4B skeleton modules (`config`, `constants`, `flags`) with typed tests before broader migrations | Need stable shared contracts in place before extracting validation/permissions/api/cache concerns from features | Eng | Use new modules in scoped call-sites only when duplicate patterns are proven |
| 2026-02-18 | Enforce route-level adapter pattern for shared navigation auth/email integration | Shared navigation components must remain feature-agnostic; auth/session/email behavior moved to route adapters to preserve composition boundaries | Eng | Reuse this adapter pattern for Phase 5 workspace shell evolution |
| 2026-02-18 | Centralize email rendering palette into a dedicated token contract and remove chart color-literal selectors | Phase 4 token governance required eliminating hardcoded color matching drift while preserving email client rendering compatibility | Eng | Keep email palette changes in `template-tokens.ts` and prevent raw literals in shared UI surfaces |
